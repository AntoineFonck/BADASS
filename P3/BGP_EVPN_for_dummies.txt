BGP EVPN for dummies

1) What is BGP ?
2) What is EVPN ?
3) How does BGP EVPN relate to VXLAN ?

--------------------------------------------------

1) What is BGP (RFC 4271) ?

BGP (Border Gateway Protocol) is the routing protocol powering the internet.

The internet is a network composed of independant networks.
We call those independant networks "AS" (Autonomous System(s)).

One AS is usually under the control of a single company/organization.
An AS is composed of one or several public IP range(s).

BGP is used by routers to connect multiple AS to each other.

eBGP (exterior BGP) is used by routers between two AS.
iBGP (interior BGP) is used by routers inside a single AS (usually only to forward eBGP routes troughout a single network).

When routers use BGP under the same ASN (Autonomous System Number), they automatically use iBGP.

--------------------------------------------------

2) What is EVPN (RFC 7432) ?

EVPN (Ethernet Virtual Private Network) is a modern Layer 2 VPN solution (modern, as the official RFC came out in February 2015).

A VPN (Virtual Private Network) is a technology that extends a private network, by creating a virtual link between this private network and another one, usually through tunneling.
A well known use case it to let clients connect to a private network to which they do not originally belong.
For instance: a company VPN that lets workers connect to the company's internal network through the internet, allowing them to work from home.

As a L2VPN, EVPN is a solution to extend and interconnect L2 domains.
Typically, it is used to virtually interconnect datacenters over an IP network.

To create this interconnection, EVPN implements a control plane through BGP, more precisely through the MP-BGP extensions (RFC 4760).

The control plane refers to all functions and processes that determine how packets should be forwarded.
For instance, a router sharing connectivity information to another router through BGP.

The data plane refers to all functions and processes that actually forward the packets (based on information given through the control plane).
For instance, a router forwarding a packet after checking its routing table.

In EVPN, devices called Provider Edge (PE) provide virtual Layer 2 connectivity between Customer Edge (CE) devices.
PEs advertise the MAC addresses learned from the CEs that are connected to them.

BGP EVPN introduces the concept of MAC routing between PEs, which is very convenient for VXLAN...

--------------------------------------------------

3) How does BGP EVPN relate to VXLAN (RFC 8365) ?

BGP EVPN is an elegant solution to handle a single or multiple VXLAN network(s).
Basically, it brings a solid control plane to VXLAN, which lacks one by default.

More precisely, BGP EVPN is a solution for VTEPs to avoid :
	- using multicast or hardcoded IPs to reach other VTEPs
	- learning dynamically about hosts behind VTEPs (by analyzing incoming packets, which can also cause a security risk if an attacker sends a fake REAL_SERVER_MAC:ATTACKER_VTEP_IP association to a victim VTEP. See here for full details: https://connect.ed-diamond.com/MISC/misc-110/securite-de-l-implementation-standard-de-vxlan (FR)).

By solving these two problems, we can achieve large scale and resilient VXLAN infrastructure deployments.

--------------------------------------------------
